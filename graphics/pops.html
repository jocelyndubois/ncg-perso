<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

	<link rel="stylesheet" href="css/global.css"/>
	<link rel="stylesheet" href="css/pops.css"/>

	<script src="js/clock.js"></script>
	<script src="js/color.js"></script>
</head>
<body>
	<div class="container"></div>

	<script>
		const container = document.querySelector('.container');

		const width = nodecg.bundleConfig.pops.width;
		const heigth = nodecg.bundleConfig.pops.height;

		container.style.width = width + 'px';
		container.style.height = heigth + 'px';

		nodecg.listenFor('popItem', () => {
			createPop();
		});

		nodecg.listenFor('popBigItem', () => {
			createPop(true);
		});

		function createPop(big = false)
		{
			let img = document.createElement('img');
			let size = 100;
			if (big) {
				size = 200;
				img.classList.add('bigPop');
				img.src = 'img/bigPop.png'
			} else {
				img.classList.add('pop');
				img.src = 'img/pop.png'
			}

			let posX = Math.floor(Math.random() * (width - size)) + 'px';
			let posY = Math.floor(Math.random() * (heigth - size)) + 'px';

			img.style.left = posX;
			img.style.top = posY;

			setTimeout(function(){
				img.remove();
				endAnim(big,posX,posY);
			}, 10000);

			container.appendChild(img);
		}
		
		function endAnim(big,posX,posY){
			let img = document.createElement('img');
			let size = 100;
			if (big) {
				return;
			} else {
				img.classList.add('pop');
				img.src = 'img/mario.gif'
			}

			img.style.left = posX;
			img.style.top = posY;

			setTimeout(function(){
				img.remove();
			}, 2000);

			container.appendChild(img);
		}
	</script>
</body>
</html>
